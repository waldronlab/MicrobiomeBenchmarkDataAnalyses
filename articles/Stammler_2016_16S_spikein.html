<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sammler_2016_16S_spikein - Spike-in bacteria â€¢ MicrobiomeBenchmarkDataAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sammler_2016_16S_spikein - Spike-in bacteria">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MicrobiomeBenchmarkDataAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/MicrobiomeBenchmarkDataAnalyses.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/HMP_2012_16S_gingival_V13.html"> HMP_2012_16S_gingival_V13 - subgingival vs supgragingival plaque</a>
    </li>
    <li>
      <a href="../articles/HMP_2012_16S_gingival_V35_subset.html">HMP_2012_16S_gingival_V35_subset - subgingival vs supragingival</a>
    </li>
    <li>
      <a href="../articles/HMP_2012_16S_gingival_V35.html"> HMP_2012_16S_gingival_V35 - subgingival vs supgragingival plaque</a>
    </li>
    <li>
      <a href="../articles/HMP_2012_WMS_gingival.html">HMP_2012_WMS_gingiva - Supragingival vs subgingival plaque</a>
    </li>
    <li>
      <a href="../articles/Ravel_2011_16S_BV.html">Ravel_2011_16S_BV - Bacterial vaginosis</a>
    </li>
    <li>
      <a href="../articles/Stammler_2016_16S_spikein.html">Sammler_2016_16S_spikein - Spike-in bacteria</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/MicrobiomeBenchmarkDataAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><link href="Stammler_2016_16S_spikein_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="Stammler_2016_16S_spikein_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/datatables-binding-0.33/datatables.js"></script><link href="Stammler_2016_16S_spikein_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Stammler_2016_16S_spikein_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="Stammler_2016_16S_spikein_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="Stammler_2016_16S_spikein_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/selectize-0.12.0/selectize.min.js"></script><link href="Stammler_2016_16S_spikein_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="Stammler_2016_16S_spikein_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="Stammler_2016_16S_spikein_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="Stammler_2016_16S_spikein_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="Stammler_2016_16S_spikein_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="Stammler_2016_16S_spikein_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sammler_2016_16S_spikein - Spike-in
bacteria</h1>
            <h3 data-toc-skip class="subtitle">Comparison of coefficient
of variation of spike-in bacteria across samples</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/MicrobiomeBenchmarkDataAnalyses/blob/main/vignettes/articles/Stammler_2016_16S_spikein.Rmd" class="external-link"><code>vignettes/articles/Stammler_2016_16S_spikein.Rmd</code></a></small>
      <div class="hidden name"><code>Stammler_2016_16S_spikein.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/MicrobiomeBenchmarkDataAnalyses" class="external-link">MicrobiomeBenchmarkDataAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/MicrobiomeBenchmarkData" class="external-link">MicrobiomeBenchmarkData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/StoreyLab/biobroom" class="external-link">biobroom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The objective of this vignette is to compare the coefficient of
variation (CV) of the three spike-in bacteria in the
<em>Stammler_2016_16S_spikein</em> dataset using relative abundance
(TSS) and centered-log-ratio transformation (CLR). However, since CLR is
log transformed and TSS is not, a geometric mean normalization (GMN)
method will be used instead of CLR.</p>
<p><em>S. ruber</em> will be used for re-calibrating the abundance data
(counts). This is referred to as SCML. The data will also be normalized
with TSS (TSS) or GMN (GMN). The CV of the abundance data of the three
spike-in bacteria across samples using these two normalization methods
will be calculated and compared.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://waldronlab.io/MicrobiomeBenchmarkData/reference/getBenchmarkData.html" class="external-link">getBenchmarkData</a></span><span class="op">(</span><span class="st">'Stammler_2016_16S_spikein'</span>, dryrun <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="recalibrate-with-spike-in-salinibacter-ruber">Recalibrate with spike-in Salinibacter ruber<a class="anchor" aria-label="anchor" href="#recalibrate-with-spike-in-salinibacter-ruber"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spk_bac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    `S. ruber` <span class="op">=</span> <span class="st">'AF323500XXXX'</span>, </span>
<span>    `R. radiobacter` <span class="op">=</span> <span class="st">'AB247615XXXX'</span>,</span>
<span>    `A. acidiphilus` <span class="op">=</span> <span class="st">'AB076660XXXX'</span></span>
<span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">'counts'</span><span class="op">)</span></span>
<span><span class="va">s_ruber</span> <span class="op">&lt;-</span> <span class="va">counts</span><span class="op">[</span><span class="va">spk_bac</span><span class="op">[</span><span class="st">'S. ruber'</span><span class="op">]</span>, <span class="op">]</span></span>
<span><span class="va">size_factor</span> <span class="op">&lt;-</span> <span class="va">s_ruber</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_ruber</span><span class="op">)</span></span>
<span><span class="va">SCML_data</span> <span class="op">&lt;-</span> <span class="va">counts</span> </span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">SCML_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">SCML_data</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">SCML_data</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="va">size_factor</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">'SCML'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">SCML_data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tranform-with-tss-relative-abundance-and-clr">Tranform with TSS (relative abundance) and CLR<a class="anchor" aria-label="anchor" href="#tranform-with-tss-relative-abundance-and-clr"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gmn_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">"TSS"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">'counts'</span><span class="op">)</span>, <span class="fl">2</span>,  <span class="va">tss_fun</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">"GMN"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">'counts'</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">gmn_fun</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="extract-data-of-sipike-in-bacteria">Extract data of sipike-in bacteria<a class="anchor" aria-label="anchor" href="#extract-data-of-sipike-in-bacteria"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spk_bac_tse</span> <span class="op">&lt;-</span> <span class="va">tse</span><span class="op">[</span><span class="va">spk_bac</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">spk_bac_tse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spk_bac</span><span class="op">)</span></span>
<span><span class="va">spk_bac_tse</span></span>
<span><span class="co">#&gt; class: TreeSummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 3 17 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(4): counts SCML TSS GMN</span></span>
<span><span class="co">#&gt; rownames(3): S. ruber R. radiobacter A. acidiphilus</span></span>
<span><span class="co">#&gt; rowData names(1): taxonomy</span></span>
<span><span class="co">#&gt; colnames(17): MID26 MID27 ... MID42 MID43</span></span>
<span><span class="co">#&gt; colData names(12): dataset subject_id ... country description</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(0):</span></span>
<span><span class="co">#&gt; rowLinks: NULL</span></span>
<span><span class="co">#&gt; rowTree: NULL</span></span>
<span><span class="co">#&gt; colLinks: NULL</span></span>
<span><span class="co">#&gt; colTree: NULL</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-tidy-data">Get tidy data<a class="anchor" aria-label="anchor" href="#get-tidy-data"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">spk_bac_tse</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/biobroom/man/SummarizedExperiment_tidiers.html" class="external-link">tidy.RangedSummarizedExperiment</a></span><span class="op">(</span><span class="va">spk_bac_tse</span>, assay <span class="op">=</span> <span class="va">.x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="st">"sample"</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html" class="external-link">reduce</a></span><span class="op">(</span>.f <span class="op">=</span> \<span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="st">"sample"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">data</span>, filter <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"50\" data-max=\"30124\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"97\" data-max=\"17882\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.001470673049195\" data-max=\"0.744231434359406\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34.0721142865609\" data-max=\"29178.9112583046\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51"],["S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus","S. ruber","R. radiobacter","A. acidiphilus"],["MID26","MID26","MID26","MID27","MID27","MID27","MID28","MID28","MID28","MID29","MID29","MID29","MID30","MID30","MID30","MID32","MID32","MID32","MID33","MID33","MID33","MID34","MID34","MID34","MID35","MID35","MID35","MID36","MID36","MID36","MID37","MID37","MID37","MID38","MID38","MID38","MID39","MID39","MID39","MID40","MID40","MID40","MID41","MID41","MID41","MID42","MID42","MID42","MID43","MID43","MID43"],[533,1926,50,761,3045,60,1258,4941,134,2645,9790,284,1475,7306,135,865,5255,80,3983,18157,210,3238,17645,320,1469,6259,199,2769,11329,265,3893,30124,523,1574,5680,85,796,4733,101,3966,21175,455,515,3175,70,4824,17141,202,4721,24122,256],[2311,8350,217,2311,9247,182,2311,9076,246,2311,8553,248,2311,11446,212,2311,14039,214,2311,10534,122,2311,12593,228,2311,9846,313,2311,9455,221,2311,17882,310,2311,8339,125,2311,13740,293,2311,12338,265,2311,14247,314,2311,8211,97,2311,11807,125],[0.01539881192687006,0.05556837187842436,0.001470673049195455,0.02663683713776348,0.1064774355926871,0.002132345230188416,0.03209196808646224,0.1259718080089725,0.003441156228492774,0.07799557848194547,0.2886072218128224,0.008400884303610906,0.03259285430375834,0.1613522943072914,0.003003135626904562,0.03049081050630237,0.185057390324625,0.002851911837194564,0.1222010919575486,0.5569596957241887,0.006471995583093062,0.0868271499034956,0.4730323825863178,0.008604975337765388,0.04017710724827812,0.1710943478736198,0.005466273095003827,0.0717003597960293,0.293272590790257,0.006885305308932777,0.09620040515835762,0.7442314343594051,0.01294530362172044,0.05013528569154863,0.1808371796912303,0.002737545758395671,0.02240337315530569,0.1330709768095573,0.00286718200983837,0.09834155531867424,0.5249510399365378,0.01130419693100969,0.01441743503772003,0.08873987147247835,0.001983794355965354,0.140654151119403,0.4997084888059701,0.00591767723880597,0.116130936278006,0.5932711935269669,0.006320552863923662],[356.7550790004616,1287.391455494175,34.07211428656094,635.9125688264442,2541.98121344534,50.90638674332427,1039.242906793044,4079.379225870709,111.4358954861485,2243.199248934529,8300.515437006039,241.6144315745808,1342.44246850005,6645.817830169286,123.6938859864545,682.1625372211838,4140.238216668063,63.80504101029548,3703.422795060426,16879.20459656306,196.1401128910015,3169.984919238674,17270.00737415426,314.1602837528911,1206.865869837535,5139.442411689096,164.1994380731341,2377.42327670039,9724.261994590403,228.3012966073298,3771.707234517447,29178.9112583046,507.5435518456965,1236.705249172304,4460.776203522451,67.52803265321789,664.1955432326321,3945.171520280151,85.00369562073836,3623.213720925885,19340.85549642716,416.4823435195875,418.8128558300505,2577.809360690389,57.62735031770075,4249.866149801628,15098.69544868383,178.802658737768,4613.04983505568,23566.41278505891,251.0702684475455]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>taxon<\/th>\n      <th>sample<\/th>\n      <th>counts<\/th>\n      <th>SCML<\/th>\n      <th>TSS<\/th>\n      <th>GMN<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"taxon","targets":1},{"name":"sample","targets":2},{"name":"counts","targets":3},{"name":"SCML","targets":4},{"name":"TSS","targets":5},{"name":"GMN","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="calculate-coefficient-of-variation">Calculate coefficient of variation<a class="anchor" aria-label="anchor" href="#calculate-coefficient-of-variation"></a>
</h2>
<div class="section level3">
<h3 id="define-a-formula-for-calculating-coefficient-of-variation">Define a formula for calculating coefficient of variation<a class="anchor" aria-label="anchor" href="#define-a-formula-for-calculating-coefficient-of-variation"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_cv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">n</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">}</span> </span>
<span>    <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cv</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>cv <span class="op">=</span> <span class="va">statistic</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_res</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">taxon</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="va">counts</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">get_cv</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>        cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">'norm'</span>, values_to <span class="op">=</span> <span class="st">'cv_res'</span> </span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="st">'cv_res'</span><span class="op">)</span></span>
<span>   </span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">cv_res</span>, filter <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span>     </span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"81.858861610131\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-3.0883625622683\" data-max=\"0\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"11.3297100291406\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12"],["A. acidiphilus","A. acidiphilus","A. acidiphilus","A. acidiphilus","R. radiobacter","R. radiobacter","R. radiobacter","R. radiobacter","S. ruber","S. ruber","S. ruber","S. ruber"],["counts","SCML","TSS","GMN","counts","SCML","TSS","GMN","counts","SCML","TSS","GMN"],[68.25116287252597,31.96686368936649,61.92496819788023,73.85990492870756,75.3057049918058,24.3339705598298,70.20549475260556,81.85886161013096,66.3164218434565,0,64.75342474915504,71.34015889007644],[-2.543191805103831,-0.8989321085234181,-2.566854564313907,-2.870153846726041,-2.148367966540434,-1.144319772792315,-1.869570895677043,-3.088362562268301,-1.324756566500682,0,-1.127077255881936,-1.674279581305655],[10.0327014430624,5.270646541417224,8.774789772124151,11.32971002914064,10.26043884385774,3.765254866742038,8.992572732644694,11.24111510158127,9.365795642637114,0,9.138910982343026,10.27377945187224]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>taxon<\/th>\n      <th>norm<\/th>\n      <th>cv<\/th>\n      <th>bias<\/th>\n      <th>std.error<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"taxon","targets":1},{"name":"norm","targets":2},{"name":"cv","targets":3},{"name":"bias","targets":4},{"name":"std.error","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>Table in wider format:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_res</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>        Species <span class="op">=</span> <span class="va">taxon</span>, `Normalization method` <span class="op">=</span> <span class="va">norm</span>,</span>
<span>        CV <span class="op">=</span> <span class="va">cv</span>, SE <span class="op">=</span> <span class="va">std.error</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Normalization method`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMN"</span>, <span class="st">"TSS"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">bias</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        CV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">CV</span>, <span class="fl">1</span><span class="op">)</span>, SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">SE</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `Normalization method` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>            test <span class="op">=</span> <span class="va">`Normalization method`</span> <span class="op">==</span> <span class="st">"TSS"</span>, </span>
<span>            yes <span class="op">=</span> <span class="st">"Relative abundance"</span>,</span>
<span>            no <span class="op">=</span> <span class="va">`Normalization method`</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span></span>
<span>        extensions <span class="op">=</span> <span class="st">'Buttons'</span>,,</span>
<span>        filter <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        dom <span class="op">=</span> <span class="st">'Bfrtip'</span>,</span>
<span>        buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                extend <span class="op">=</span> <span class="st">'copy'</span>,</span>
<span>                text <span class="op">=</span> <span class="st">'Copy '</span></span>
<span>                <span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"61.9\" data-max=\"81.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"8.8\" data-max=\"11.3\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["1","2","3","4","5","6"],["A. acidiphilus","A. acidiphilus","R. radiobacter","R. radiobacter","S. ruber","S. ruber"],["Relative abundance","GMN","Relative abundance","GMN","Relative abundance","GMN"],[61.9,73.90000000000001,70.2,81.90000000000001,64.8,71.3],[8.800000000000001,11.3,9,11.2,9.1,10.3]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Species<\/th>\n      <th>Normalization method<\/th>\n      <th>CV<\/th>\n      <th>SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":[{"extend":"copy","text":"Copy "}],"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Species","targets":1},{"name":"Normalization method","targets":2},{"name":"CV","targets":3},{"name":"SE","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="compare-coefficient-of-variation">Compare coefficient of variation<a class="anchor" aria-label="anchor" href="#compare-coefficient-of-variation"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_res</span> <span class="op">|&gt;</span>  </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">norm</span> <span class="op">!=</span> <span class="st">'counts'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        norm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">norm</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">'counts'</span>, <span class="st">'SCML'</span>, <span class="st">'TSS'</span>,  <span class="st">'GMN'</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>taxon <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span><span class="va">taxon</span>, <span class="st">'S. ruber'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">norm</span>, <span class="va">cv</span><span class="op">)</span>, <span class="va">cv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">norm</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">cv</span> <span class="op">-</span> <span class="va">std.error</span>, ymax <span class="op">=</span> <span class="va">cv</span> <span class="op">+</span> <span class="va">std.error</span>, color <span class="op">=</span> <span class="va">norm</span><span class="op">)</span>,</span>
<span>        width <span class="op">=</span> <span class="fl">0.4</span>, size <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'qual'</span>, palette <span class="op">=</span> <span class="st">'Set2'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">taxon</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="st">'Coefficient of variation across all samples'</span>,</span>
<span>        x <span class="op">=</span> <span class="st">'Data transformation'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        <span class="co"># axis.text.x = element_text(angle = 45, hjust = 1),</span></span>
<span>        panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">'italic'</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">'none'</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="Stammler_2016_16S_spikein_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>TSS normalizaion has lower CV values than GMN. This could indicate
that it introduces less bias than GMN, which is related to CLR.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] purrr_1.0.2                            </span></span>
<span><span class="co">#&gt;  [2] ggplot2_3.5.1                          </span></span>
<span><span class="co">#&gt;  [3] biobroom_1.36.0                        </span></span>
<span><span class="co">#&gt;  [4] broom_1.0.6                            </span></span>
<span><span class="co">#&gt;  [5] tidyr_1.3.1                            </span></span>
<span><span class="co">#&gt;  [6] tibble_3.2.1                           </span></span>
<span><span class="co">#&gt;  [7] dplyr_1.1.4                            </span></span>
<span><span class="co">#&gt;  [8] MicrobiomeBenchmarkData_1.6.0          </span></span>
<span><span class="co">#&gt;  [9] TreeSummarizedExperiment_2.12.0        </span></span>
<span><span class="co">#&gt; [10] Biostrings_2.72.1                      </span></span>
<span><span class="co">#&gt; [11] XVector_0.44.0                         </span></span>
<span><span class="co">#&gt; [12] SingleCellExperiment_1.26.0            </span></span>
<span><span class="co">#&gt; [13] SummarizedExperiment_1.34.0            </span></span>
<span><span class="co">#&gt; [14] Biobase_2.64.0                         </span></span>
<span><span class="co">#&gt; [15] GenomicRanges_1.56.1                   </span></span>
<span><span class="co">#&gt; [16] GenomeInfoDb_1.40.1                    </span></span>
<span><span class="co">#&gt; [17] IRanges_2.38.1                         </span></span>
<span><span class="co">#&gt; [18] S4Vectors_0.42.1                       </span></span>
<span><span class="co">#&gt; [19] BiocGenerics_0.50.0                    </span></span>
<span><span class="co">#&gt; [20] MatrixGenerics_1.16.0                  </span></span>
<span><span class="co">#&gt; [21] matrixStats_1.3.0                      </span></span>
<span><span class="co">#&gt; [22] MicrobiomeBenchmarkDataAnalyses_0.99.11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] DBI_1.2.3               sandwich_3.1-0          rlang_1.1.4            </span></span>
<span><span class="co">#&gt;  [4] magrittr_2.0.3          multcomp_1.4-25         compiler_4.4.1         </span></span>
<span><span class="co">#&gt;  [7] RSQLite_2.3.7           systemfonts_1.1.0       vctrs_0.6.5            </span></span>
<span><span class="co">#&gt; [10] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0          </span></span>
<span><span class="co">#&gt; [13] backports_1.5.0         dbplyr_2.5.0            labeling_0.4.3         </span></span>
<span><span class="co">#&gt; [16] utf8_1.2.4              rmarkdown_2.27          UCSC.utils_1.0.0       </span></span>
<span><span class="co">#&gt; [19] ragg_1.3.2              bit_4.0.5               xfun_0.45              </span></span>
<span><span class="co">#&gt; [22] modeltools_0.2-23       zlibbioc_1.50.0         cachem_1.1.0           </span></span>
<span><span class="co">#&gt; [25] jsonlite_1.8.8          blob_1.2.4              highr_0.11             </span></span>
<span><span class="co">#&gt; [28] DelayedArray_0.30.1     BiocParallel_1.38.0     parallel_4.4.1         </span></span>
<span><span class="co">#&gt; [31] R6_2.5.1                RColorBrewer_1.1-3      coin_1.4-3             </span></span>
<span><span class="co">#&gt; [34] bslib_0.7.0             boot_1.3-30             jquerylib_0.1.4        </span></span>
<span><span class="co">#&gt; [37] Rcpp_1.0.12             knitr_1.48              zoo_1.8-12             </span></span>
<span><span class="co">#&gt; [40] Matrix_1.7-0            splines_4.4.1           tidyselect_1.2.1       </span></span>
<span><span class="co">#&gt; [43] abind_1.4-5             yaml_2.3.9              codetools_0.2-20       </span></span>
<span><span class="co">#&gt; [46] curl_5.2.1              lattice_0.22-6          treeio_1.28.0          </span></span>
<span><span class="co">#&gt; [49] withr_3.0.0             evaluate_0.24.0         desc_1.4.3             </span></span>
<span><span class="co">#&gt; [52] survival_3.7-0          BiocFileCache_2.12.0    pillar_1.9.0           </span></span>
<span><span class="co">#&gt; [55] filelock_1.0.3          DT_0.33                 generics_0.1.3         </span></span>
<span><span class="co">#&gt; [58] munsell_0.5.1           scales_1.3.0            tidytree_0.4.6         </span></span>
<span><span class="co">#&gt; [61] glue_1.7.0              lazyeval_0.2.2          tools_4.4.1            </span></span>
<span><span class="co">#&gt; [64] forcats_1.0.0           fs_1.6.4                mvtnorm_1.2-5          </span></span>
<span><span class="co">#&gt; [67] grid_4.4.1              ape_5.8                 crosstalk_1.2.1        </span></span>
<span><span class="co">#&gt; [70] libcoin_1.0-10          colorspace_2.1-0        nlme_3.1-165           </span></span>
<span><span class="co">#&gt; [73] GenomeInfoDbData_1.2.12 cli_3.6.3               textshaping_0.4.0      </span></span>
<span><span class="co">#&gt; [76] fansi_1.0.6             S4Arrays_1.4.1          gtable_0.3.5           </span></span>
<span><span class="co">#&gt; [79] yulab.utils_0.1.4       sass_0.4.9              digest_0.6.36          </span></span>
<span><span class="co">#&gt; [82] SparseArray_1.4.8       TH.data_1.1-2           farver_2.1.2           </span></span>
<span><span class="co">#&gt; [85] htmlwidgets_1.6.4       memoise_2.0.1           htmltools_0.5.8.1      </span></span>
<span><span class="co">#&gt; [88] pkgdown_2.1.0           lifecycle_1.0.4         httr_1.4.7             </span></span>
<span><span class="co">#&gt; [91] bit64_4.0.5             MASS_7.3-61</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel David Gamboa-Tuz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
